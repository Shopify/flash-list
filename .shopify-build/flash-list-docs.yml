#include "shared/containers.yml"

steps:
  # Build the documentation to make sure there aren't breaking changes
  # This won't publish the changes to the documentation website (that only happens on the "main" branch)
  - label: Build documentation
    branches: "!main"
    timeout: 5m
    run:
      - cd documentation
      - yarn: ~
      - yarn build

  # Publish the Website on the microsites ".docs.shopify.io" domain
  # Only executes on the main branch, after PRs get merged
  # https://buildkite.com/shopify/flash-list-docs
  - label: Publish Documentation Website
    branches: "main"
    container: docs_container
    timeout: 10m
    git:
      history: shallow
    run:
      - cd /projects/api-node && ./assemble --type=docs --microsite-root=/documentation --override-subdomain=flash-list
